<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign up</title>
    <link rel="stylesheet" href="SignupStyle.css">
</head>

<body>

    <header>
        <div class="logo">
            <a href="#">
                <img src="images/Spotify logo.png" alt="Spotify Logo">
            </a>
        </div>
    </header>

    <section>
        <div class="main">
            <h1>Sign up to Budgify</h1>

            <hr>

            <form id="signupForm">
                <input type="text" id="name" placeholder="Name" required>
                <input type="text" id="username" placeholder="Username" required>
                <input type="email" id="email" placeholder="Email" required>
                <input type="password" id="password" placeholder="Password" required>
                <input type="text" id="country" placeholder="Country" required>
                <input type="text" id="gender" placeholder="Gender">
                <input type="number" id="subscription_id" placeholder="Subscription ID" value="1" style="display:none">
                <input type="text" id="parental_controls" placeholder="Parental Controls">
                <input type="date" id="date_of_birth" placeholder="Date of Birth" required>
                <input type="text" id="phone_number" placeholder="Phone Number">

                <button class="sign-up" type="submit">
                    Sign up
                </button>
            </form>

            <hr>

            <div class="last">
                <span>Have an account?</span>
                <a href="Login.html">Log in to Budgify</a>
            </div>
        </div>
    </section>

    <script>
       document.getElementById("signup-form").addEventListener("submit", function(event) {
    event.preventDefault(); // Prevent form submission

    // Get user data from the form
    const userData = {
        name: document.getElementById("name").value,
        username: document.getElementById("username").value,
        email: document.getElementById("email").value,
        password: document.getElementById("password").value,
        country: document.getElementById("country").value,
        gender: document.getElementById("gender").value,
        subscription_id: 1,  // Example, you can set it dynamically if needed
        parental_controls: document.getElementById("parental_controls").value,
        date_of_birth: document.getElementById("date_of_birth").value,
        phone_number: document.getElementById("phone_number").value,
        created_date: new Date().toISOString().slice(0, 10)  // Current date as "yyyy-mm-dd"
    };

    // Send POST request to signup API
    fetch('http://localhost:8080/api/users/signup', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify(userData)
    })
    .then(response => {
        if (response.status === 201) {
            alert("User registered successfully!");
            window.location.href = "http://127.0.0.1:8081/Webpage/BudgifyMainPage.html";  // Redirect on success
        } else {
            return response.text();  // Get the error message
        }
    })
    .then(errorMessage => {
        if (errorMessage) {
            alert("Error: " + errorMessage);
        }
    })
    .catch(error => {
        console.error('Error during signup:', error);
    });
});

        </script>
        

</body>

</html>
